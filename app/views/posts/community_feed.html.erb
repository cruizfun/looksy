<style>

.avatar {
  vertical-align: middle;
  width: 50px;
  height: 50px;
  border-radius: 50%;
}

.btn {
  
  background-color: Violet; /* Violet background */
  border: none; /* Remove borders */
  color: white; /* White text */
  font-size: 14px; /* Set a font size */
  cursor: pointer; /* Mouse pointer on hover */
}

.btn:hover {
  background-color: Tomato;
}

.square {
  position: relative;
  width: 300px;     
  height: 300px;
  overflow: hidden;
}

  img {
     position: absolute;
     max-width: 100%;
     width: 100%;
     height: auto;
     top: 50%;     
     left: 50%;
     transform: translate( -50%, -50%);
}

  img.landscape {
    height: 100%;
    width: auto;
}

.overlay {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  height: 100%;
  width: 100%;
  opacity: 0;
  transition: .3s ease;
  background-color: white;
}

.square:hover .overlay {
  opacity: 0.5;
  color: violet;
}

.icon {
  color: violet;
  font-size: 100px;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  -ms-transform: translate(-50%, -50%);
  text-align: center;
}

.fa-user:hover {
  color: Tomato;
}

</style>

<div class="container">
    <div class="row">
      <div class="col" align="left">
        <h1>
          Rosey Style Feed
        </h1>
      </div>
    </div>
    <div class="row">
      <div class="col" align="left">
        <body> 
          <form action="/new_post">
            <button type="submit" class="btn"> Upload a new post </button>
          </form>
        </body>
      </div>
    </div>
  <hr>
  <% @posts.each do |post| %>
    <% vote1 = Vote.where({ :voter_id => @current_user.id, :bestoutfit_id => post.outfit1_id }).first %>
    <% vote2 = Vote.where({ :voter_id => @current_user.id, :bestoutfit_id => post.outfit2_id }).first %>

    <% vote1_count = Vote.where({ :bestoutfit_id => post.outfit1_id }).all.count %>
    <% vote2_count = Vote.where({ :bestoutfit_id => post.outfit2_id }).all.count %>

    <% style1 = Outfit.where({ :id => post.outfit1_id }).first %>
    <% style1_image = style1.image %>

    <% style2 = Outfit.where({ :id => post.outfit2_id }).first %>
    <% style2_image = style2.image %>
          
    <% poster = User.where({ :id => post.poster_id }).first %>
    <% poster_username = poster.username %>
    <% if Headshot.where({ :id => poster.headshot_id }).first.image == nil %>
    <% poster_avatar = cl_image_tag("non_existing_id.png", 
                 :width => 100, :height => 100, 
                 :crop => :thumb, :gravity => :face, :radius => 20, 
                 :default_image => "avatar.png") %>
    <% else %>
      <% poster_avatar = Headshot.where({ :id => poster.headshot_id }).first.image %>
    <% end %>
    
    <div class="row">
        <div class="col-12" align="left">
    <div class="media border p-3">

          <img src="<%= poster_avatar %>" alt="Avatar" class="avatar">
      <div class="media body">
          <%= poster_username %> | Posted <%= time_ago_in_words(post.created_at) %> ago
      </div>
    </div>
    </div>
    </div>
    <div class="row">
        <div class="col-4">
          <div class="square">
            <img height=100 src="<%= style1_image %>" class="img" width="50" height="50" alt="image"> 
            <% if vote1 == nil && vote2 ==nil %>
              <form action="/insert_vote" method="post">
                <div class="overlay">
                  <input type="hidden" value="<%= post.id %>" name="post_id_from_query">
                  <input type="hidden" value="<%= post.outfit1_id %>" name="bestoutfit_id_from_query">          
                  <a href="/feed" class="icon" title="User Profile">
                    <i class="fas fa-heart"></i>
                  </a>
                </div>
              </form>
            <% else %>
            <% end %>
          </div>
        </div>
        <div class="col-4"></div>
        <div class="col-4">
          <div class="square">
            <img height=100 src="<%= style2_image %>" class="img" width="50" height="50" alt="Image"> 
            <% if vote1 == nil && vote2 ==nil %>
              <form action="/insert_vote" method="post">
                <div class="overlay">
                  <input type="hidden" value="<%= post.id %>" name="post_id_from_query">
                  <input type="hidden" value="<%= post.outfit2_id %>" name="bestoutfit_id_from_query">          
                  <a href="/feed" class="icon" title="User Profile">
                    <i class="fas fa-heart"></i>
                  </a>
                  </div>
                </form>
            <% else %>
            <% end %>
          </div>
        </div>
    </div>

    <div class="row">
        <div class="col-4"></div>
        <div class="col-4"> 
          <% if vote1 == nil && vote2 ==nil %>
          <% elsif vote1 != nil %>
            You upvoted this look!
          <% else %>
          <% end %>           
        </div>
        <div class="col-2"></div>
        <div class="col-4">
          <% if vote1 == nil && vote2 ==nil %>
          <% elsif vote2 != nil %>
            You upvoted this look!
          <% else %>
          <% end %>
        </div>
    </div>

    <div class="row">
        <div class="col-4">
          <% if vote1_count > vote2_count %>
            Rosey loves this look!

          <% else %>
          <% end %>
        </div>
        <div class="col-4"></div>
        <div class="col-4">
          <% if vote2_count > vote1_count %>
            Rosey loves this look!

          <% else %>
          <% end %>
        </div>
    </div>

  <% end %>
</div>
  